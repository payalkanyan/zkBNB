use dep::noir_ml::{layers::fc, activations::relu, utils::arg_max};
use dep::std;
global w1: [Field; 1600] = [12025903, -85711002, -15415594, 7897472, -147743225, -155442029, -195934981, 31153906, -130845651, 95421739, -92673652, -146134451, 16510140, -97898893, -185341910, -78871042, -151520148, -194034129, -183098987, -21045843, -57104178, -116701409, 10196203, -131707519, -221925735, -19914772, -142978, 7672180, 187121183, 192188188, -173027441, 151612625, 19321134, -174447760, -232663259, -192193151, -112766765, -72349429, -3133292, -26232371, -11867165, -200148553, 107495345, 74985422, 23070401, -23275103, -107768290, -59590921, -139894441, 149777249, -185015872, 103800282, 101511173, -92864856, -224166989, -20997781, -229765505, -241909191, -122782953, 203143775, -68243958, 98250546, -71692571, 125641242, -4550883, 27798487, -76049335, -152664885, 6951877, -4185463, 62510371, -171683908, -190325782, 50194304, -32972440, 56094609, -61386794, 114788748, -50903503, -89410447, -175393090, -13276652, -45282759, -113694198, -97374529, 15057684, 102786228, 261549622, -58804397, -123665787, -165837899, -191861480, 146333814, -266847789, -30869424, 181978539, 3566206, -202335715, -63082203, -12190992, 36661047, -76940775, -190904543, -133906558, -665921, -104196288, -143957138, 195532724, 13547782, -37724409, -92147671, -126418069, -200154155, -241892666, 19397464, -233579218, -203660414, 62380355, -195438147, -114941239, 816360, -174570367, -160505608, -143392980, -26648298, -63978180, 131287768, 113714799, 76411180, -200462565, -122344628, 58377467, -31595007, -148075551, 80623023, -88099308, 123353988, -162323892, 39641447, -86450726, -176255375, 36483660, -105090134, -49662642, -99491484, -28937882, -92393711, 51147312, -81645906, 129436523, 54658413, -43029808, -50565258, -80521725, -70641406, 94797492, 47927976, 46226300, -169929102, -15729070, -221515343, 32566037, 59558768, 67148909, -33372238, -92890047, 22931084, -151228607, -48344571, 66756338, 71183838, -29580079, 618700, 28742757, -87507337, -37557676, 27675664, 74649923, -152910694, 97513549, -54961491, -58329631, 98523408, -33858381, 34203328, -41494433, -185304314, -57300810, 342899501, 8190649, 155767977, 345033139, -28311208, 42809572, 56456629, -97273313, 58195923, -56975439, -14148483, -84687918, -7213579, -70108466, -169598952, -11883425, 64498320, 7459390, -72869577, -3737145, -1404135, 24739146, -119781874, 17544435, -130468309, 28688736, 40607508, -15288774, -88282816, 53161081, -27293386, 5136371, -16490517, 141280606, -361048579, -87819502, 30033009, -6383273, -72266005, -194825292, 97414993, -143723130, -47361191, -174404278, 50343622, -14775169, 81547275, 52575018, -178367853, 76566361, -242780551, -107691579, -15059422, -172572508, 11438333, -32865930, 5685771, -121687613, 72035193, 118341364, 165415883, 54926664, -141170561, -138463855, 71503028, -300929874, -61097063, -161819085, -145770222, -18803326, -83873250, -9444531, 78813337, -43004122, 80289811, -20288799, 88023990, -20948393, -49307693, 3045379, -121838562, 103610702, 43121953, -160379961, -177185044, 87277487, 1161330, -105132870, -58838241, -98360434, -55761348, 204985857, -72448730, -15561253, -10174468, -194582209, -18080996, -82841896, 355504125, 279315412, -82566068, -100354664, -126863286, -119724162, 63410342, 108984694, 5836928, -248761848, 2932297, -73067240, 30173339, 61009333, 56153946, -29403998, 54480862, -49547117, 111090533, 63073300, 29459806, -77199757, -147175252, 144616902, -134480879, -77520907, -40641777, 32526884, -111715272, -57422489, 38462184, 44911981, -352755934, -134579718, -175662756, -103560716, 4992510, 78296155, -76520510, -112415068, -131287500, -61033987, -123261735, -6402093, 26324561, 104509242, 86354196, -83787039, 83621942, -51481958, 75810440, -126113281, 115935586, -62140096, 39539643, 99485435, -42944841, 38607012, -72826922, 147779360, 119723476, -33753417, -356235296, 267597318, 258237690, -65489881, -201672807, 15557466, -165004432, -62134173, -203897938, -65590218, -152141973, -40624298, 34283146, -36549196, -207514554, 46858463, 69369763, -218944177, 123311870, -229263946, 60124110, -40458187, -43113139, -154067442, 58752067, -7644975, -95055506, -101719111, 31178946, 76380186, -182062730, -215923175, -220524117, -95981248, -144422829, -63796669, -148282796, -109288529, 40153522, 16857293, -43481577, -36181070, 27703440, -84558882, 38220167, -209657013, -64938515, -100702219, -219702244, -155289695, 6722215, -123086803, -232256055, 70605002, -134169966, -64702466, 62304977, 32352798, -217923805, 76136403, -98667227, -42755537, 71685664, 44308148, 26836378, -82249664, 56095455, 112372741, -222357407, -185869172, 32364793, -209164634, -231631085, 45861147, -3293219, -36164857, 84735177, -73354095, 106224746, -190976769, -229626819, -114895925, 100264736, -229201496, -2323335, -30182434, -151311949, -223711416, -3325740, -11769550, -78263663, 96177861, 137226596, -83775744, -182424814, -113301799, -110006563, -67901440, 46527192, -135655805, 33650409, -106250390, -88282660, -62116638, -172622964, -191313073, 14197582, -84626354, -115032978, 55875711, 104840472, -54106306, -142463788, 56556303, -83655633, -120243415, -58495313, -66849336, 139891714, -68775006, -218923360, -79778880, 36575541, 14688008, -182467759, -204478830, -98293036, 24910320, 61266106, 295866519, -33177763, 102833405, -153829, -32451425, -34717407, 8354793, -181488469, -76333128, 104026385, -153432518, -67128070, 32814536, -75959451, 29557779, 11119528, -70882186, -126639217, 54463081, 12341575, -147539258, 99380709, 101043440, 88602081, -38049784, 71537502, -166156352, -309384048, 219369695, -250309110, 341356009, 103189930, -4017442, 613171518, 152570754, -101785563, -24664620, -16168766, -139075682, 91016777, 91360055, -109912276, -27029835, -6956145, 28611636, -69342285, 3726502, -75376831, 81191398, 51425267, 68375066, 29716643, 6905428, -55130083, -51336221, -201960459, 160179093, -116418496, -50824478, -65437496, 48795070, -166961908, 47227785, -191572860, 12971045, -185427621, -289613456, 24723135, 58639586, -41408081, -112933204, 55419687, 63531563, -51516011, -125589341, 7732954, -55350807, -144720376, -16012469, 23726474, -19562751, 30543832, 40712591, -12022661, -36177810, -96825331, 14039439, -132787168, 62644802, -31661838, -96029654, -67453280, 62503733, -22528095, 20869257, -102397554, -74522741, 401528984, 344170421, -74130550, -208226502, 72577588, -25924409, 24914075, 34876645, 17052513, -60399368, -800131, 36362197, -22794683, -165909201, 96873008, -139939681, 45298528, -126782194, -95359184, -136156246, -157586887, -114121400, 106437504, -14352929, -78271225, -132047579, -81954949, 113712758, -106022574, -255102634, -97753890, -119165361, -78559741, 93551919, -14855810, 17966397, -107591048, -172937781, 25368022, 31394035, -148018450, 56847528, -130235910, -197544441, 15226190, -65710902, -200169370, 43930043, 197705090, 49387813, -12531569, 25965406, -172798976, -18209664, -82120970, -141285315, -64199641, -29972361, -80871701, -108149633, -195689783, -34661874, -151225477, 57791460, -108590871, 66698566, -183473706, -118100956, -152720451, -162556648, -54872908, -148628235, -150394753, -37209585, 2189287, -157999635, 29543556, 29554995, 95080018, -53508852, 70680790, -232428834, -22436120, -223974809, -621223, -141857788, -98327696, 76664835, 105110697, 8079975, -53474963, 159025759, -11220103, -95699877, -32587115, 175671205, 10484576, 34563467, -204603374, 18814983, -274184197, -155424207, -85163884, 35897885, -122922190, -33482164, 25740718, -39382663, 41519590, -100684844, 54366294, -103055298, -122992732, -21134919, 60758758, -109878704, -129672959, -172755226, -166212127, -8039022, -99506043, -67460217, 34279734, 34856945, -45470878, 77157162, 58156487, -39505191, -137213632, -126703516, 23318078, -54817818, -204765454, -68894736, -38550124, -2201505, 94224542, -74428439, -54569729, 54891188, -73159486, -20965690, -213563472, -130677000, -146482095, -59942771, -151475787, 119223766, -112965830, -184110895, -70766523, -139789462, -184080869, 46648413, -29952254, -57263341, 23958407, -20110453, 100242272, 350759149, -76473877, 71229309, 31214556, -101658009, 22671819, -73639393, -100335285, -3867673, -87857537, -105657443, -35876982, 12029613, -123726197, -204495907, -193551466, 106969051, -6452493, 15598518, -183495149, -31727374, -161334649, -25177071, 125157863, 145334870, -91762751, -118155263, -222909853, -150029957, 36124084, -50319836, 123060904, 114131495, 110308878, -42767927, -99579565, 7485666, 21965453, 55392340, 26608968, -191933289, 38737081, -188884661, 79886086, 56093905, -84257841, -8255532, -80314472, -15339173, 116078712, -27907770, -57337876, -23771463, -9406139, -186949775, -33542056, -121273965, 76945953, 22398839, -94652049, 99853590, -32110710, 69610611, -41685641, -93007796, -358950973, -237290904, -21249628, -74644245, -127432331, 4827823, 63610636, 26004292, -50737284, 14122547, -58768556, -196500838, -233837694, -186602384, -180724204, 76677315, -92083119, -174496517, -31486765, -75803228, -181520998, -244015694, -37305783, -85383877, -144177258, -86656690, -23661526, 210468292, -215228140, -70051201, -56247965, 162031487, 10772437, 120515063, -52903309, -83938166, 12295553, -166253179, 44357922, 71087159, -30287858, 13336235, -166701183, 74524932, -146444812, -1374540, -52928198, -54869611, 45869626, -231278852, 118766420, -78878462, 99996217, -24921268, -167285606, 102833800, -6508538, -264048904, -63595958, -269235045, -193963677, -218065292, -73995180, -173200846, -79736665, -210301995, -217452258, -57126068, -41185055, 73058136, -93613543, 79600431, -176002473, -15738439, -229963005, 104660630, -123319857, 21384707, -46792287, -116746716, -125724733, -99236585, 26565911, 46333093, 80153309, -109974578, -91957748, -155635148, -52369788, 24704494, -29571099, -115865789, -21306375, -55232521, -223655328, -48081249, -7234171, -171689764, -325383, -18936709, -64981103, -46196975, -70406154, 21681469, -82891226, -72694965, 93536235, -86794250, -8152437, -242181763, -203851789, -89842565, -94210267, 97457632, -70533209, -180748284, 119728282, -193840176, 67406550, -72137155, -22712421, -267236710, 67746758, -104343794, -160247713, -194480821, -21311704, -166903198, 131060287, 96881583, 42349983, 26093638, -182750881, -114992455, 4402902, 43052737, 85914448, -178721413, -21932205, -74941896, 15825124, -122583009, 33159375, -121356621, 103378318, 64280167, -124283411, -21284247, -140600383, 38344484, 50927915, -43424565, -136883497, -170176357, 37947856, -39812975, -84925957, 130261779, 20756779, 164597362, -209209993, -113336071, 1301985, 8986951, -31348497, -80943197, -6842900, -184872538, -3061647, 34152213, -59192892, 20209532, -113196813, -165364221, -141842887, 147425443, -152507201, -152778536, 131507948, -207967028, 76327309, 47546368, -107150778, 17550934, 89460298, -165595919, -96972808, 16183758, -8442885, -156867281, -261388540, 5347605, 15132610, -73983975, 11050076, -150573328, -101281516, -108528949, 88002875, 4333999, 104401655, -111530401, 77721022, -178113297, 52070402, -59945013, -72900295, 66861689, 30274536, -143783331, -99762827, -5873288, -65187335, 46857622, -191994563, -131948978, 136723027, -127566665, -232384279, 96739061, -82780905, 118108541, 303347260, 150513217, -344314307, -21756263, 37270043, -128591105, -15584890, 35011344, -41357465, -226601794, 72690561, 28221359, 1172472, -75139515, -158043727, -32576751, -147611007, 85522078, -157342583, -27897496, -6741130, 20597, -33872031, 46140779, -190700710, 49846221, -163406491, -19670263, -115015425, -53264976, 99981047, -37413508, -175910279, 7592893, 24997368, -316562891, 19481402, -81466675, -42249657, 9303547, -90958916, -172367021, -5652324, 86607888, -6117335, -42420536, -19558387, 72331421, 48494440, -124244504, 54185599, -19337961, -137186632, -126069888, -45625012, -157522485, -166180447, 23734888, 103478715, -170342013, 119788654, -123946153, 4879325, 49582046, -89160904, -157060593, 50951973, -110575818, -115529343, -153074160, -5112366, 20061910, 15049088, -81008822, 85421674, 102730982, -153396592, 70766620, -75496592, 33958808, 39500836, 51039927, -181283399, -69818579, -143203273, -153712764, -87978125, -4594106, 12678827, -60472891, 65300331, 123497128, 125982687, 38485684, -138070747, -23087593, -20905217, -114687666, 145831347, 41645028, 1992878, -89887783, 47777776, -20984558, -136932388, -10246963, -122430481, -123079188, -25615664, 37134789, -165997371, -97948186, 110774934, -118972301, -203572616, -204202980, 30737413, 52592751, 117342085, -196639940, -3091589, -38624529, -28767098, 81920624, -100329690, -117956772, -81931397, 13178288, 44792380, -25268957, -176550448, 110386416, -183818072, -38244657, -187322244, 58220163, 57106402, -136231646, 57108585, -104600079, -236155674, -91932476, -195048556, -29675402, -34244783, -145248398, -107573256, -24207126, -153193459, 24399202, -180749655, 52001290, -146432713, -207718134, -21329023, -45097888, -203209728, 90377122, -123824693, 56434996, -105708659, 118217275, -85218437, -122871675, -175116912, -121157259, -113562882, 41491680, -142208785, -48825126, -87660901, -93798570, -32929361, 81357554, -99907480, -173808098, 98818108, -122915559, 107669428, -41206852, -47031958, 149597615, 16745048, -197786599, -209463522, -204514906, -183726028, 9693487, 25071017, 46824586, -217452675, 95664255, 116070971, 69387555, -69693521, -153294802, 33612847, -51803201, -37159316, -66011071, 59192717, -217490867, 40805858, -147673979, 80637373, -165000364, -93052968, 19935207, 35893857, 41323978, -103657819, 23190677, -188507706, -74509755, -27087808, 87382101, -149092883, -109345384, -130513906, 7919575, -43935075, 30058654, 102070369, -120980814, -39964769, -161443293, -170109019, 22482499, -76433681, -161746651, -260332763, -42821493, -82320295, -48817940, -128767937, -76763496, -161580041, 82159169, -246473283, -77749476, -89001589, -112628728, -1076653, 124060325, 53403880, -176015809, -155056924, 48104130, 120635241, -193819880, -85373148, -24990471, 21884788, 136322, -181251869, -29678926, -40868193, 13570100, -67379132, -82516402, 49021959, -103435479, 32021783, -168832242, -84230497, 33519305, -18908827, -158479020, 68047397, -96560806, -35797723, -49747989, 112720318, 2234290, -28399171, -67175344, 96717685, 12514700, 21858932, -98324738, -148314014, 57024054, -187848762, -136617735, 120667227, 33993170, -156398952, 34803964, -110500075, -145711258, 190296233, 139201626, -182181627, -69074698, -194135413, -145406306, -11540998, -2848995, -120941766, -97851299, -201414049, -160105959, -55602551, -34134436, 63169591, 76088540, 101836808, 7492679, -177215472, -93832918, -192448407, -48794787, 75133532, -20253116, 47956109, 137169555, 74240379, -61920948, 127487242, 6473497, -177836448, -60600720, 161989093, 56698635, 67709468, -152226716, -51137529, 81678025, -122335292, -150499627, 44027641, 21167077, 50225589, -90269208, 48025001, -138318360, -115329199, 20136070, -141674191, -13359697, -101839028, 78671813, -83796725, 8044585, -2278365, 68525620, -28530249, 61402250, -39660797, -180022374, -57056617, -26042091, -120620400, -8167523, 254347265, -23564279, -1555381, 923617, -46290316, 9757065, -181057557, -270300597, -175450236, -122294381, 135639742, -112163045, 113835573, -13045107, -54791272, -203672156, -216942698, -150274307, -137444139, 96101999, -100077070, -87278098, -64690627, 76711252, -108637363, -15994225, -219490200, -257515520, -128491774, -9668428, 10992783, -2324759, 204633743, -50492834, -40849227, 38908761, -170552105, 61208241, -191305131, 56526434, 42654406, 60679581, -45819718, -66720448, -152434111, 95630370, -82425125, -87616436, 46032552, 38178004, -57311170, -132866696, -48609681, 32082491, -43511838, -45876924, 8372963, -81874035, 68371877, -123047777, 180386662, 39841607, 47626786, 137660906, -325177372, 50325327, -130808353, -196570575, 2400345, -40239766, -182017580, -160966724, 78813508, -243718460, -43429784, -67625962, -206529886, 70117474, -186568201, 16949261, -117056929, 128079042, -137819320, -179878011, -41021738, 110953905, -123180687, 97133070, 95685489, 47098663, -7419549, 247784629, 4490596, -52774731, -53267907, -54506220, -96209295, -44865780, 53286877, -6026770, -93322560, 75855896, -141167790, 25109898, -131294385, 10738665, 38123161, -18447377, -93564928, 40650617, -30376267, 5956763, -27251771, -51672995, -19009579, -140763700, 10930968, 104251020, -3781209, -40042043, 38629554, -154306352, 26829256, -169580489, 38900439, -145102069, 11962390, 185401827, -169564992, -235862687, -58918998, -26285792, -113838598, 72439857, 43220349, 1765660, -139830098, 85101366, -147652641, -168803006, -84491804, -48320342, 105172731, 40675636, -45952167, -76380312, 56174196, 93350329, -207959577, 84333062, -2261753, -21268200, 31014737, 110686198, -20112256, -83271876, -171073750, -193920478, -3461317, -186035633, 293901920, -49827036, 38164683, -207190499, 57905987, -37581693, -214522824, 27947150, -134867430, -176051825, -5235690, -73350221, -1378616, 75813472, -206197098, 115909226, -101128235, -90113841, 100821942, -86640775, -105334543, -91255687, 16324038, -29118145, 105222084, 12948058, -226404786, -192001835, -34017205, -16304480, -42284634, -13449124, 7751842, -179208145, -75743079, -7053887, 11485970, -34824528, 28229093, 6415481, -216985658, -191886231, -10933241, 41300219, -134227008, -113631099, -234849930, 59608873, 125435606, 86869411, -209437415, 116448157, -142091677, -210056111, 48273370, 119720466, -64814605, -134994671, -66152677, -11956060, 603199, -158099040, -62940881, 51574674, -50273839, -39126448];
global b1: [Field; 50] = [-443899423, 81515647, 20839043, 137587398, 63645855, -91898136, -243824169, -30970005, -153567731, -244179174, -66248246, 563915372, 46873704, -76623283, -387997240, -3796296, 34031559, -75826250, -211741328, -438450158, -173674762, 815232396, -189841762, -42691141, -62841982, -239770353, -76691166, -260390610, 1603743, -149902090, 285653085, 59565376, -258367032, 58355365, -184395358, -233872667, 29702799, -124695458, -208464324, -202959418, -198812619, -199636981, -63015029, -297324747, -138734877, 35909500, -273579836, 52592810, 34234285, -58338311];

global w2: [Field; 100] = [-1355782, -30394051, 99989429, 66780664, 42201016, 34644779, -5405928, -111833356, 64423762, -101923309, 38268428, -15079670, -112698287, -38843807, -29612813, 62164716, 12550753, -40469423, -20328309, -102277033, 19960374, 83945751, -64891137, 85410900, -25751885, 87153286, -51708072, 85008070, 7367805, -35421964, 23331745, 50846081, -22028912, 7246563, -8484128, -13484025, -25240662, 53032540, -23511836, 41537967, 11076468, 57458095, 3248082, -62093750, -59021417, -26108896, 38473569, -38587779, -33027280, 29748075, -11526329, -17390151, 99114560, 70430972, 42136114, 34400068, -5385491, -112582713, 64310327, -101829514, 37553892, -99862650, -116429515, 38225517, -31937946, 60883302, 12550918, -40466916, -20741776, -106799364, 62730946, 66324502, -63957334, 85481763, -25643775, 88265061, -50298240, 85688986, -41593082, -35509393, 29515188, 50345361, -22622248, 7575329, -8509212, -11683894, -24842646, 87286822, -23499120, 88190429, 10238480, 90459101, 3150197, -55424619, -59101768, 27154097, 38581733, -38854830, -33966407, 27436981];
global b2: [Field; 2] = [-34730323, -63664965];

fn main(input: pub [Field; 32], intent: pub Field, hash: pub Field) {
  let hash1 = std::hash::mimc_bn254(input);
  assert(hash == hash1);

  let output = input;
  let output = relu(fc(output, w1, b1));
  let output = arg_max(fc(output, w2, b2));
  assert(output == intent);
}